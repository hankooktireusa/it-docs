---
layout: default
title: 🧮 Evaluation Order in the RBAC System
permalink: /en/web/proposals/ePortal-roles/evaluation-order/
---

<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
{% include lang-toggle.html %}

<h1>🧮 Evaluation Order in the RBAC System</h1>

<p>This document explains how user permissions are determined in the new Role-Based Access Control (RBAC) model. The system moves from broad role assignment down to precise overrides, ensuring both flexibility and adherence to the Principle of Least Privilege.</p>

<details>
  <summary><strong>📑 Table of Contents</strong></summary>
  <ul>
    <li><a href="#role-assignment">1. 🧱 Role Assignment</a></li>
    <li><a href="#role-scoping">2. 🧭 Role Scoping (Optional)</a></li>
    <li><a href="#role-combination">3. ➕ Role Combination and Merging</a></li>
    <li><a href="#restrictive-roles">4. 🚫 Restrictive Roles (Modifiers)</a></li>
    <li><a href="#direct-overrides">5. 🛠️ Direct Privilege Overrides (Edge Cases)</a></li>
    <li><a href="#summary-table">🔁 Summary Table</a></li>
  </ul>
</details>

<hr />

<h2 id="role-assignment">1. 🧱 Role Assignment</h2>
<p>Each user is assigned one or more roles, which define:</p>
<ul>
  <li>A set of <strong>permissions</strong> (e.g., <em>Order Submission</em>, <em>Warranty Status</em>)</li>
  <li>The associated <strong>privileges</strong> for each permission:
    <ul>
      <li><code>A</code> – Access</li>
      <li><code>S</code> – Stock</li>
      <li><code>U</code> – Unit Price</li>
      <li><code>L</code> – List Price</li>
    </ul>
  </li>
</ul>
<p>📚 These roles are defined in <a href="./role-definitions.html">role-definitions</a> and serve as the foundational access model.</p>

<hr />

<h2 id="role-scoping">2. 🧭 Role Scoping (Optional)</h2>
<p>Roles may be scoped to narrow their effect:</p>
<ul>
  <li><strong>Corporation</strong> (e.g., US, CA, MX)</li>
  <li><strong>Industry Segment</strong> (e.g., Retail, Fleet, Insurance)</li>
  <li><strong>Feature → Action → Channel</strong> combinations</li>
</ul>
<p>▶ If scoped, the role only applies <strong>within that context</strong>.</p>

<hr />

<h2 id="role-combination">3. ➕ Role Combination and Merging</h2>
<p>When users have multiple roles:</p>
<ul>
  <li>Permissions from all roles are <strong>merged</strong></li>
  <li>Privileges on a shared permission are <strong>unified</strong> (logical union)</li>
</ul>
<p>📝 Example:<br>
If one role grants <code>A, S</code> on <em>Order Submission</em> and another grants <code>U</code>, the result is <code>A, S, U</code>.</p>

<hr />

<h2 id="restrictive-roles">4. 🚫 Restrictive Roles (Modifiers)</h2>
<p>Some roles act to <strong>remove</strong> privileges rather than add them.</p>
<ul>
  <li>Example: <code>No Pricing</code> role removes all <code>U</code> and <code>L</code> privileges across all applicable permissions.</li>
  <li>These are layered <strong>after</strong> role merging.</li>
</ul>
<p>🔒 Used to enforce restrictions such as <code>[SH-N]</code> legacy group logic.</p>

<hr />

<h2 id="direct-overrides">5. 🛠️ Direct Privilege Overrides (Edge Cases)</h2>
<p>In rare exceptions:</p>
<ul>
  <li>Privileges may be directly added or removed at the <strong>user level</strong></li>
  <li>These overrides apply <strong>after all roles and restrictions</strong> have been evaluated</li>
</ul>
<p>⚠️ This should be used <strong>sparingly</strong>, only when roles cannot fully express the necessary access pattern.</p>

<hr />

<h2 id="summary-table">🔁 Summary Table</h2>
<table>
  <thead>
    <tr>
      <th>Level</th>
      <th>Description</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Base Role</strong></td>
      <td>Main source of permissions/privileges</td>
      <td><code>Order – WH Order Submission (A, S, U)</code></td>
    </tr>
    <tr>
      <td><strong>Scoped Role</strong></td>
      <td>Role limited by corporation/segment/channel</td>
      <td><code>Warranty – Create Warranty (CA only)</code></td>
    </tr>
    <tr>
      <td><strong>Role Merging</strong></td>
      <td>Combines all roles for cumulative access</td>
      <td><code>Order + Status + Warranty</code></td>
    </tr>
    <tr>
      <td><strong>Restrictive Role</strong></td>
      <td>Reduces privileges granted by base roles</td>
      <td><code>No Pricing</code> removes <code>U</code>, <code>L</code></td>
    </tr>
    <tr>
      <td><strong>Direct Overrides</strong></td>
      <td>Final edge-case adjustment at user level</td>
      <td>Add <code>U</code> to <em>Stock Report</em> for one user only</td>
    </tr>
  </tbody>
</table>
