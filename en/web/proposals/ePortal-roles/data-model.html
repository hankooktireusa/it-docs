---
layout: default
title: 📊 RBAC Data Model
permalink: /en/web/proposals/ePortal-roles/data-model/
---

<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
{% include lang-toggle.html %}

<h1>📊 RBAC Data Model</h1>

<p>This document describes the relational structure of the new Role-Based Access Control (RBAC) system, including support for corporations, industry segments, permissions, and privilege-based access levels.</p>

<details>
  <summary><strong>📑 Table of Contents (click to expand)</strong></summary>
  <ul>
    <li><a href="#users"><code>users</code></a></li>
    <li><a href="#roles"><code>roles</code></a></li>
    <li><a href="#user_roles"><code>user_roles</code></a></li>
    <li><a href="#role_corporation"><code>role_corporation</code></a></li>
    <li><a href="#role_industry_segment"><code>role_industry_segment</code></a></li>
    <li><a href="#permissions"><code>permissions</code></a></li>
    <li><a href="#privileges"><code>privileges</code></a></li>
    <li><a href="#role_permissions"><code>role_permissions</code></a></li>
  </ul>
</details>

<hr />

<h2>Core Tables</h2>

<hr />

<h3 id="users"><code>users</code></h3>
<p>Represents system users who are assigned roles.</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>id</code></td><td>INT</td><td>Primary key</td></tr>
  <tr><td><code>email</code></td><td>VARCHAR</td><td>User email address</td></tr>
</table>

<hr />

<h3 id="roles"><code>roles</code></h3>
<p>Reusable role templates assigned to users and scoped to corporations and segments.</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>id</code></td><td>INT</td><td>Primary key</td></tr>
  <tr><td><code>name</code></td><td>VARCHAR</td><td>Role display name</td></tr>
  <tr><td><code>description</code></td><td>TEXT</td><td>Optional description</td></tr>
</table>

<hr />

<h3 id="user_roles"><code>user_roles</code></h3>
<p>Links users to their assigned roles.</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>user_id</code></td><td>INT</td><td>FK to <code>users.id</code></td></tr>
  <tr><td><code>role_id</code></td><td>INT</td><td>FK to <code>roles.id</code></td></tr>
</table>

<hr />

<h3 id="role_corporation"><code>role_corporation</code></h3>
<p>Scopes roles to one or more corporations (e.g., US, CA, MX).</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>role_id</code></td><td>INT</td><td>FK to <code>roles.id</code></td></tr>
  <tr><td><code>corporation</code></td><td>VARCHAR</td><td>Country code (e.g., <code>US</code>)</td></tr>
</table>

<hr />

<h3 id="role_industry_segment"><code>role_industry_segment</code></h3>
<p>Scopes roles to one or more industry segments (e.g., Fleet, Retail).</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>role_id</code></td><td>INT</td><td>FK to <code>roles.id</code></td></tr>
  <tr><td><code>industry_segment</code></td><td>VARCHAR</td><td>Segment code or label</td></tr>
</table>

<hr />

<h3 id="permissions"><code>permissions</code></h3>
<p>Represents a unique action under a feature (e.g., “Order Submission”).</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>id</code></td><td>INT</td><td>Primary key</td></tr>
  <tr><td><code>name</code></td><td>VARCHAR</td><td>Permission name</td></tr>
  <tr><td><code>feature</code></td><td>VARCHAR</td><td>e.g., Order, Warranty, Report</td></tr>
  <tr><td><code>action</code></td><td>VARCHAR</td><td>e.g., Create, Status</td></tr>
</table>

<hr />

<h3 id="privileges"><code>privileges</code></h3>
<p>Defines the level of access granted to a permission.</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>code</code></td><td>CHAR(1)</td><td>One of: <code>A</code>, <code>S</code>, <code>U</code>, <code>L</code></td></tr>
  <tr><td><code>label</code></td><td>VARCHAR</td><td>Access, Stock, Unit, List Price</td></tr>
</table>

<hr />

<h3 id="role_permissions"><code>role_permissions</code></h3>
<p>Joins roles to permissions with specific privileges.</p>
<table>
  <tr><th>Column</th><th>Type</th><th>Description</th></tr>
  <tr><td><code>role_id</code></td><td>INT</td><td>FK to <code>roles.id</code></td></tr>
  <tr><td><code>permission_id</code></td><td>INT</td><td>FK to <code>permissions.id</code></td></tr>
  <tr><td><code>privilege_code</code></td><td>CHAR(1)</td><td>FK to <code>privileges.code</code></td></tr>
</table>

<h2>🧭 Entity Relationship Diagram</h2>

<h3>Text Version</h3>
<pre>
           ┌───────────┐
           │   users   │
           └─────┬─────┘
                 │
                 ▼
          ┌──────────────┐
          │  user_roles  │
          └────┬────┬────┘
               │    │
               ▼    ▼
           ┌───────────┐
           │   roles   │
           └───┬──┬──┬─┘
               │  │  └───────────────────────────────────────────┐
               │  └─────────────────────┐                        │
               ▼                        ▼                        ▼
     ┌──────────────────┐ ┌──────────────────────────────┐ ┌────────────────────┐
     │ role_corporation │ │ role_industry_segment        │ │  role_permissions  │
     └──────────────────┘ └──────────────────────────────┘ └──────────┬─────────┘
                                                                     │
                                                                     ▼
                                                              ┌─────────────┐
                                                              │ permissions │
                                                              └──────┬──────┘
                                                                     │
                                                                     ▼
                                                               ┌────────────┐
                                                               │ privileges │
                                                               └────────────┘
</pre>

<h3>🔧 Example: What This Looks Like in Practice</h3>
<p>A user is assigned the role <strong>“Order – WH Order Submission”</strong>, scoped to the <strong>US Corporation</strong> and <strong>Fleet Segment</strong>, and is granted:</p>
<ul>
  <li><strong>Permission:</strong> Order Submission</li>
  <li><strong>Feature:</strong> Order</li>
  <li><strong>Action:</strong> Create</li>
  <li><strong>Privileges:</strong> A, S, U</li>
</ul>

<hr />

<h3>🗂️ Data Rows Involved</h3>

<h4><code>users</code></h4>
<table>
<tr><th>id</th><th>email</th></tr>
<tr><td>2001</td><td>johndoe@example.com</td></tr>
</table>

<hr />

<h4><code>roles</code></h4>
<table>
<tr><th>id</th><th>name</th></tr>
<tr><td>1</td><td>Order – WH Order Submission</td></tr>
</table>

<hr />

<h4><code>user_roles</code></h4>
<table>
<tr><th>user_id</th><th>role_id</th></tr>
<tr><td>2001</td><td>1</td></tr>
</table>

<hr />

<h4><code>role_corporation</code></h4>
<table>
<tr><th>role_id</th><th>corporation</th></tr>
<tr><td>1</td><td>US</td></tr>
</table>

<hr />

<h4><code>role_industry_segment</code></h4>
<table>
<tr><th>role_id</th><th>industry_segment</th></tr>
<tr><td>1</td><td>Fleet</td></tr>
</table>

<hr />

<h4><code>permissions</code></h4>
<table>
<tr><th>id</th><th>name</th><th>feature</th><th>action</th></tr>
<tr><td>101</td><td>Order Submission</td><td>Order</td><td>Create</td></tr>
</table>

<hr />

<h4><code>privileges</code></h4>
<table>
<tr><th>code</th><th>label</th></tr>
<tr><td>A</td><td>Access</td></tr>
<tr><td>S</td><td>Stock</td></tr>
<tr><td>U</td><td>Unit Price</td></tr>
<tr><td>L</td><td>List Price</td></tr>
</table>

<hr />

<h4><code>role_permissions</code></h4>
<table>
<tr><th>role_id</th><th>permission_id</th><th>privilege_code</th></tr>
<tr><td>1</td><td>101</td><td>A</td></tr>
<tr><td>1</td><td>101</td><td>S</td></tr>
<tr><td>1</td><td>101</td><td>U</td></tr>
</table>
